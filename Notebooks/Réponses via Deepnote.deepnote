metadata:
  createdAt: '2025-11-28T09:34:20.284Z'
  modifiedAt: '2025-12-01T13:57:49.272Z'
project:
  id: c58cfd1e-ddf2-4b4c-a25b-5b012084bab0
  name: max-b-max’s Untitled project
  integrations:
    - id: 79129477-f8a5-4066-9268-a1f0943d81ee
      name: Aircraft_analytics
      type: snowflake
  notebooks:
    - blocks:
        - blockGroup: 7195626866b8488c86d4df01a9086b0a
          content: ''
          id: 6ed6865b04854cbfac54d438366c6ba1
          metadata:
            formattedRanges: []
          sortingKey: a0
          type: text-cell-p
        - blockGroup: aaab428ecd8b4ca29ecb25760cb6ee30
          content: |+
            SELECT 
                f.aircraft_type,
                COUNT(*) AS total_flights
            FROM analytics.dbt_mbreuillard.fct_individual_flights f
            GROUP BY f.aircraft_type
            ORDER BY total_flights DESC;

          id: 00f24d0557874780b4615d71cebc8e2f
          metadata:
            execution_start: 1764347405156
            execution_millis: 3880
            sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
            execution_context_id: 94d00937-cba5-47dc-8729-04374b15675c
            deepnote_variable_name: df_1
            deepnote_return_variable_type: dataframe
          sortingKey: m
          type: sql
          executionCount: 1
          outputs:
            - data:
                application/vnd.deepnote.sql-output-metadata+json:
                  status: success_no_cache
                  size_in_bytes: 501
                  compiled_query: |-
                    SELECT 
                        f.aircraft_type,
                        COUNT(*) AS total_flights
                    FROM analytics.dbt_mbreuillard.fct_individual_flights f
                    GROUP BY f.aircraft_type
                    ORDER BY total_flights DESC;
                    /* {"app":"deepnote","submitted_by":"user","user_email":"maxbreuillard@gmail.com","workspace_id":"a9190dce-d37e-4e25-9fc6-41e64813a5a6","project_id":"c58cfd1e-ddf2-4b4c-a25b-5b012084bab0","notebook_id":"bc4730be67b5410399901766344c501e","project_url":"https://deepnote.com/project/c58cfd1e-ddf2-4b4c-a25b-5b012084bab0"} */;
                  variable_type: dataframe
                  integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
              execution_count: 0
              output_type: execute_result
              metadata:
                cellId: 00f24d0557874780b4615d71cebc8e2f
                execution_start: 1764347405156
                execution_millis: 3880
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 94d00937-cba5-47dc-8729-04374b15675c
                deepnote_variable_name: df_1
                deepnote_return_variable_type: dataframe
                cellIndex: 1
            - data:
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>aircraft_type</th>
                        <th>total_flights</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>Goose</td>
                        <td>2016</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>Thundercat</td>
                        <td>1106</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>Bezantium</td>
                        <td>480</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>Miniflock</td>
                        <td>277</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>Flockinator</td>
                        <td>192</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 2
                  columns:
                    - name: aircraft_type
                      dtype: object
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: Goose
                            count: 1
                          - name: Thundercat
                            count: 1
                          - name: 3 others
                            count: 3
                    - name: total_flights
                      dtype: int64
                      stats:
                        unique_count: 5
                        nan_count: 0
                        min: '192'
                        max: '2016'
                        histogram:
                          - bin_start: 192
                            bin_end: 374.4
                            count: 2
                          - bin_start: 374.4
                            bin_end: 556.8
                            count: 1
                          - bin_start: 556.8
                            bin_end: 739.2
                            count: 0
                          - bin_start: 739.2
                            bin_end: 921.6
                            count: 0
                          - bin_start: 921.6
                            bin_end: 1104
                            count: 0
                          - bin_start: 1104
                            bin_end: 1286.4
                            count: 1
                          - bin_start: 1286.4
                            bin_end: 1468.8
                            count: 0
                          - bin_start: 1468.8
                            bin_end: 1651.2
                            count: 0
                          - bin_start: 1651.2
                            bin_end: 1833.6000000000001
                            count: 0
                          - bin_start: 1833.6000000000001
                            bin_end: 2016
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 5
                  preview_row_count: 5
                  rows:
                    - aircraft_type: Goose
                      total_flights: 2016
                      _deepnote_index_column: 0
                    - aircraft_type: Thundercat
                      total_flights: 1106
                      _deepnote_index_column: 1
                    - aircraft_type: Bezantium
                      total_flights: 480
                      _deepnote_index_column: 2
                    - aircraft_type: Miniflock
                      total_flights: 277
                      _deepnote_index_column: 3
                    - aircraft_type: Flockinator
                      total_flights: 192
                      _deepnote_index_column: 4
                  type: dataframe
                text/plain: |2-
                    aircraft_type  total_flights
                  0         Goose           2016
                  1    Thundercat           1106
                  2     Bezantium            480
                  3     Miniflock            277
                  4   Flockinator            192
              execution_count: 1
              output_type: execute_result
              metadata:
                cellId: 00f24d0557874780b4615d71cebc8e2f
                execution_start: 1764347405156
                execution_millis: 3880
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 94d00937-cba5-47dc-8729-04374b15675c
                deepnote_variable_name: df_1
                deepnote_return_variable_type: dataframe
                cellIndex: 1
                table_state_spec: '{}'
        - blockGroup: bc58577b96e549afbff0ec616d35d8c1
          content: ''
          id: 04c8ca84bd0b474a8ffcc32445779f9b
          metadata:
            execution_start: 1764347409513
            execution_millis: 215
            execution_context_id: 94d00937-cba5-47dc-8729-04374b15675c
            deepnote_variable_name: df_1
            deepnote_config_collapsed: true
            deepnote_visualization_spec:
              layer:
                - layer:
                    - layer:
                        - mark:
                            clip: true
                            type: bar
                            color: '#2266D3'
                            tooltip: true
                          encoding:
                            x:
                              axis:
                                title: Avions
                              sort: null
                              type: nominal
                              field: aircraft_type
                              scale:
                                type: linear
                            'y':
                              axis:
                                title: Nombres de vols
                                format:
                                  type: default
                                  decimals: null
                                formatType: numberFormatFromNumberType
                              type: quantitative
                              field: total_flights
                              scale:
                                type: linear
                              format:
                                type: default
                                decimals: null
                              aggregate: sum
                              formatType: numberFormatFromNumberType
                            color:
                              type: nominal
                              datum: total_flights
                              scale:
                                range:
                                  - '#2266D3'
                                domain:
                                  - total_flights
                            xOffset:
                              datum: series_0
                          transform: []
                  resolve:
                    scale:
                      color: independent
              title: Quel avion a le plus volé ?
              config:
                legend:
                  orient: bottom
                  disable: false
              params:
                - name: valueLabelsColor
                  value: black
              $schema: https://vega.github.io/schema/vega-lite/v5.json
              encoding: {}
              usermeta:
                seriesNames:
                  - total_flights
                seriesOrder:
                  - 0
                specSchemaVersion: 2
                tooltipDefaultMode: true
            deepnote_chart_filter:
              advancedFilters: []
          sortingKey: s
          type: visualization
          executionCount: 2
          outputs:
            - data:
                application/vnd.vega.v5+json:
                  $schema: https://vega.github.io/schema/vega/v5.json
                  data:
                    - name: legend_size_0_store
                    - name: legend_color_0_store
                    - name: interval_selection_store
                    - name: source_0
                      values:
                        - aircraft_type: Goose
                          sum_total_flights: 2016
                        - aircraft_type: Thundercat
                          sum_total_flights: 1106
                        - aircraft_type: Bezantium
                          sum_total_flights: 480
                        - aircraft_type: Miniflock
                          sum_total_flights: 277
                        - aircraft_type: Flockinator
                          sum_total_flights: 192
                    - name: source_0_x_domain_aircraft_type
                      values:
                        - aircraft_type: Goose
                        - aircraft_type: Thundercat
                        - aircraft_type: Bezantium
                        - aircraft_type: Miniflock
                        - aircraft_type: Flockinator
                    - name: source_0_y_domain_sum_total_flights
                      values:
                        - min: 192
                          max: 2016
                  signals:
                    - name: width
                      init: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                    - name: height
                      init: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                    - name: unit
                      value: {}
                      'on':
                        - events: pointermove
                          update: 'isTuple(group()) ? group() : unit'
                    - name: legend_size_0
                      update: vlSelectionResolve("legend_size_0_store", "union", true, true)
                    - name: legend_color_0
                      update: vlSelectionResolve("legend_color_0_store", "union", true, true)
                    - name: interval_selection
                      update: vlSelectionResolve("interval_selection_store", "union")
                    - name: valueLabelsColor
                      value: black
                    - name: legend_size_0_tuple
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'datum && item().mark.marktype !== ''group'' && indexof(item().mark.role, ''legend'') < 0 && indexof(item().mark.name, ''interval_selection_brush'') < 0 ? {unit: "layer_0_layer_0_layer_0", fields: legend_size_0_tuple_fields, values: []} : null'
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: 'null'
                    - name: legend_size_0_tuple_fields
                      value: []
                    - name: legend_size_0_toggle
                      value: false
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'true'
                        - events:
                            - source: view
                              type: dblclick
                          update: 'false'
                    - name: legend_size_0_modify
                      'on':
                        - events:
                            signal: legend_size_0_tuple
                          update: 'modify("legend_size_0_store", legend_size_0_toggle ? null : legend_size_0_tuple, legend_size_0_toggle ? null : true, legend_size_0_toggle ? legend_size_0_tuple : null)'
                    - name: legend_color_0_tuple
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'datum && item().mark.marktype !== ''group'' && indexof(item().mark.role, ''legend'') < 0 && indexof(item().mark.name, ''interval_selection_brush'') < 0 ? {unit: "layer_0_layer_0_layer_0", fields: legend_color_0_tuple_fields, values: []} : null'
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: 'null'
                    - name: legend_color_0_tuple_fields
                      value: []
                    - name: legend_color_0_toggle
                      value: false
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'true'
                        - events:
                            - source: view
                              type: dblclick
                          update: 'false'
                    - name: legend_color_0_modify
                      'on':
                        - events:
                            signal: legend_color_0_tuple
                          update: 'modify("legend_color_0_store", legend_color_0_toggle ? null : legend_color_0_tuple, legend_color_0_toggle ? null : true, legend_color_0_toggle ? legend_color_0_tuple : null)'
                    - name: interval_selection_x
                      value: []
                      'on':
                        - events:
                            source: scope
                            filter:
                              - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                            type: pointerdown
                          update: '[x(unit), x(unit)]'
                        - events:
                            source: window
                            between:
                              - source: scope
                                filter:
                                  - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                                type: pointerdown
                              - source: window
                                type: pointerup
                            consume: true
                            type: pointermove
                          update: '[interval_selection_x[0], clamp(x(unit), 0, width)]'
                        - events:
                            signal: interval_selection_scale_trigger
                          update: '[0, 0]'
                        - events:
                            - source: view
                              type: dblclick
                          update: '[0, 0]'
                        - events:
                            signal: interval_selection_translate_delta
                          update: clampRange(panLinear(interval_selection_translate_anchor.extent_x, interval_selection_translate_delta.x / span(interval_selection_translate_anchor.extent_x)), 0, width)
                        - events:
                            signal: interval_selection_zoom_delta
                          update: clampRange(zoomLinear(interval_selection_x, interval_selection_zoom_anchor.x, interval_selection_zoom_delta), 0, width)
                    - name: interval_selection_aircraft_type
                      'on':
                        - events:
                            signal: interval_selection_x
                          update: 'interval_selection_x[0] === interval_selection_x[1] ? null : invert("x", interval_selection_x)'
                    - name: interval_selection_scale_trigger
                      value: {}
                      'on':
                        - events:
                            - scale: x
                          update: '(!isArray(interval_selection_aircraft_type) || (invert("x", interval_selection_x)[0] === interval_selection_aircraft_type[0] && invert("x", interval_selection_x)[1] === interval_selection_aircraft_type[1])) ? interval_selection_scale_trigger : {}'
                    - name: interval_selection_tuple
                      'on':
                        - events:
                            - signal: interval_selection_aircraft_type
                          update: 'interval_selection_aircraft_type ? {unit: "layer_0_layer_0_layer_0", fields: interval_selection_tuple_fields, values: [interval_selection_aircraft_type]} : null'
                    - name: interval_selection_tuple_fields
                      value:
                        - field: aircraft_type
                          channel: x
                          type: E
                    - name: interval_selection_translate_anchor
                      value: {}
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: pointerdown
                          update: '{x: x(unit), y: y(unit), extent_x: slice(interval_selection_x)}'
                    - name: interval_selection_translate_delta
                      value: {}
                      'on':
                        - events:
                            - source: window
                              between:
                                - source: scope
                                  markname: interval_selection_brush
                                  type: pointerdown
                                - source: window
                                  type: pointerup
                              type: pointermove
                              consume: true
                          update: '{x: interval_selection_translate_anchor.x - x(unit), y: interval_selection_translate_anchor.y - y(unit)}'
                    - name: interval_selection_zoom_anchor
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              consume: true
                              type: wheel
                          update: '{x: x(unit), y: y(unit)}'
                    - name: interval_selection_zoom_delta
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: wheel
                              consume: true
                          update: pow(1.001, event.deltaY * pow(16, event.deltaMode))
                          force: true
                    - name: interval_selection_modify
                      'on':
                        - events:
                            signal: interval_selection_tuple
                          update: modify("interval_selection_store", interval_selection_tuple, true)
                  marks:
                    - type: rect
                      name: interval_selection_brush_bg
                      encode:
                        update:
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                        enter:
                          fillOpacity:
                            value: 0.125
                          fill:
                            value: '#333'
                      clip: true
                    - type: rect
                      name: layer_0_layer_0_layer_0_marks
                      from:
                        data: source_0
                      encode:
                        update:
                          tooltip:
                            signal: '{"aircraft_type": isValid(datum["aircraft_type"]) ? datum["aircraft_type"] : ""+datum["aircraft_type"], "Sum of total_flights": numberFormatFromNumberType(datum["sum_total_flights"], {"decimals":null,"type":"default"})}'
                          x:
                            field: aircraft_type
                            scale: x
                            offset:
                              value: series_0
                              scale: xOffset
                          fill:
                            value: total_flights
                            scale: layer_0_layer_0_color
                          'y':
                            field: sum_total_flights
                            scale: 'y'
                          y2:
                            value: 0
                            scale: 'y'
                          opacity:
                            - value: 1
                              test: (!length(data("legend_size_0_store")) || vlSelectionTest("legend_size_0_store", datum)) && (!length(data("legend_color_0_store")) || vlSelectionTest("legend_color_0_store", datum)) && (!length(data("interval_selection_store")) || vlSelectionTest("interval_selection_store", datum))
                            - value: 0.2
                          width:
                            signal: max(0.25, bandwidth('xOffset'))
                      interactive: true
                      clip: true
                      style:
                        - bar
                    - type: rect
                      name: interval_selection_brush
                      encode:
                        update:
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          stroke:
                            - value: white
                              test: interval_selection_x[0] !== interval_selection_x[1]
                            - {}
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                        enter:
                          cursor:
                            value: move
                          fill:
                            value: transparent
                      clip: true
                  scales:
                    - name: x
                      type: band
                      domain:
                        data: source_0_x_domain_aircraft_type
                        field: aircraft_type
                      range:
                        - 0
                        - signal: width
                      paddingOuter: 0.2
                      paddingInner: 0.2
                    - name: 'y'
                      type: linear
                      domain:
                        - signal: (data("source_0_y_domain_sum_total_flights")[0] || {}).min
                        - signal: (data("source_0_y_domain_sum_total_flights")[0] || {}).max
                      range:
                        - signal: height
                        - 0
                      nice: true
                      zero: true
                    - name: xOffset
                      type: band
                      domain:
                        - series_0
                      range:
                        - 0
                        - signal: bandwidth('x')
                    - name: layer_0_layer_0_color
                      type: ordinal
                      domain:
                        - total_flights
                      range:
                        - '#2266D3'
                  axes:
                    - scale: 'y'
                      minExtent: 0
                      labels: false
                      gridScale: x
                      ticks: false
                      zindex: 0
                      domain: false
                      maxExtent: 0
                      grid: true
                      tickCount: 5
                      aria: false
                      orient: left
                    - scale: x
                      labelBaseline: middle
                      zindex: 0
                      grid: false
                      title: Avions
                      orient: bottom
                      labelAlign: right
                      labelAngle: 270
                    - scale: 'y'
                      zindex: 0
                      title: Nombres de vols
                      tickCount: 5
                      encode:
                        labels:
                          update:
                            text:
                              signal: numberFormatFromNumberType(datum.value, {"decimals":null,"type":"default"})
                      orient: left
                      grid: false
                      labelOverlap: true
                  title:
                    text: Quel avion a le plus volé ?
                    frame: group
                  usermeta:
                    tooltipDefaultMode: true
                    specSchemaVersion: 2
                    seriesNames:
                      - total_flights
                    seriesOrder:
                      - 0
                    outputMetadata:
                      rowLimitExceeded: false
                      rowLimit: 5000
                      filteredDataframeSize: 5
                      columns:
                        - name: aircraft_type
                          nativeType: object
                          distinctValues:
                            - Bezantium
                            - Flockinator
                            - Goose
                            - Miniflock
                            - Thundercat
                        - name: total_flights
                          nativeType: int64
                          distinctValues:
                            - 192
                            - 277
                            - 480
                            - 1106
                            - 2016
                  autosize:
                    type: fit
                    contains: padding
                  style: cell
                  legends:
                    - fill: layer_0_layer_0_color
                      direction: horizontal
                      symbolType: square
                      encode:
                        symbols:
                          update:
                            opacity:
                              value: 1
                  padding: 5
                  config:
                    customFormatTypes: true
                    legend:
                      orient: bottom
                      disable: false
                  background: white
                text/plain: <deepnote_toolkit.chart.deepnote_chart.DeepnoteChart at 0x7f940de488d0>
              execution_count: 2
              output_type: execute_result
              metadata:
                cellId: 04c8ca84bd0b474a8ffcc32445779f9b
                execution_start: 1764347409513
                execution_millis: 215
                execution_context_id: 94d00937-cba5-47dc-8729-04374b15675c
                deepnote_variable_name: df_1
                deepnote_config_collapsed: true
                deepnote_visualization_spec:
                  layer:
                    - layer:
                        - layer:
                            - mark:
                                clip: true
                                type: bar
                                color: '#2266D3'
                                tooltip: true
                              encoding:
                                x:
                                  axis:
                                    title: Avions
                                  sort: null
                                  type: nominal
                                  field: aircraft_type
                                  scale:
                                    type: linear
                                'y':
                                  axis:
                                    title: Nombres de vols
                                    format:
                                      type: default
                                      decimals: null
                                    formatType: numberFormatFromNumberType
                                  type: quantitative
                                  field: total_flights
                                  scale:
                                    type: linear
                                  format:
                                    type: default
                                    decimals: null
                                  aggregate: sum
                                  formatType: numberFormatFromNumberType
                                color:
                                  type: nominal
                                  datum: total_flights
                                  scale:
                                    range:
                                      - '#2266D3'
                                    domain:
                                      - total_flights
                                xOffset:
                                  datum: series_0
                              transform: []
                      resolve:
                        scale:
                          color: independent
                  title: Quel avion a le plus volé ?
                  config:
                    legend:
                      orient: bottom
                      disable: false
                  params:
                    - name: valueLabelsColor
                      value: black
                  $schema: https://vega.github.io/schema/vega-lite/v5.json
                  encoding: {}
                  usermeta:
                    seriesNames:
                      - total_flights
                    seriesOrder:
                      - 0
                    specSchemaVersion: 2
                    tooltipDefaultMode: true
                cellIndex: 2
        - blockGroup: 9e0b750934584c06abfeeec4a2708c88
          content: |
            SELECT
                airport_code,
                airport_name,
                nb_passengers
            FROM analytics.dbt_mbreuillard.fct_airport
            ORDER BY nb_passengers DESC;
          id: 4609152afcd24c9bac056d0d2a0d48c9
          metadata:
            execution_start: 1764581170676
            execution_millis: 4187
            sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
            execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
            deepnote_variable_name: df_2
          sortingKey: v
          type: sql
          executionCount: 1
          outputs:
            - data:
                application/vnd.deepnote.sql-output-metadata+json:
                  status: success_no_cache
                  size_in_bytes: 550
                  compiled_query: |-
                    SELECT
                        airport_code,
                        airport_name,
                        nb_passengers
                    FROM analytics.dbt_mbreuillard.fct_airport
                    ORDER BY nb_passengers DESC
                    /* {"app":"deepnote","submitted_by":"user","user_email":"maxbreuillard@gmail.com","workspace_id":"a9190dce-d37e-4e25-9fc6-41e64813a5a6","project_id":"c58cfd1e-ddf2-4b4c-a25b-5b012084bab0","notebook_id":"bc4730be67b5410399901766344c501e","project_url":"https://deepnote.com/project/c58cfd1e-ddf2-4b4c-a25b-5b012084bab0"} */;
                  variable_type: dataframe
                  integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
              execution_count: 0
              output_type: execute_result
              metadata:
                cellId: 4609152afcd24c9bac056d0d2a0d48c9
                execution_start: 1764581170676
                execution_millis: 4187
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_2
                cellIndex: 3
            - data:
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>airport_code</th>
                        <th>airport_name</th>
                        <th>nb_passengers</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>AMP</td>
                        <td>Amazon Mothership</td>
                        <td>2423400</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>NSA</td>
                        <td>Nestland Airport</td>
                        <td>1999700</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>FKT</td>
                        <td>Flocktopia</td>
                        <td>1685200</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 3
                  columns:
                    - name: airport_code
                      dtype: object
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: AMP
                            count: 1
                          - name: NSA
                            count: 1
                          - name: FKT
                            count: 1
                    - name: airport_name
                      dtype: object
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: Amazon Mothership
                            count: 1
                          - name: Nestland Airport
                            count: 1
                          - name: Flocktopia
                            count: 1
                    - name: nb_passengers
                      dtype: int64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: '1685200'
                        max: '2423400'
                        histogram:
                          - bin_start: 1685200
                            bin_end: 1759020
                            count: 1
                          - bin_start: 1759020
                            bin_end: 1832840
                            count: 0
                          - bin_start: 1832840
                            bin_end: 1906660
                            count: 0
                          - bin_start: 1906660
                            bin_end: 1980480
                            count: 0
                          - bin_start: 1980480
                            bin_end: 2054300
                            count: 1
                          - bin_start: 2054300
                            bin_end: 2128120
                            count: 0
                          - bin_start: 2128120
                            bin_end: 2201940
                            count: 0
                          - bin_start: 2201940
                            bin_end: 2275760
                            count: 0
                          - bin_start: 2275760
                            bin_end: 2349580
                            count: 0
                          - bin_start: 2349580
                            bin_end: 2423400
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 3
                  preview_row_count: 3
                  rows:
                    - airport_code: AMP
                      airport_name: Amazon Mothership
                      nb_passengers: 2423400
                      _deepnote_index_column: 0
                    - airport_code: NSA
                      airport_name: Nestland Airport
                      nb_passengers: 1999700
                      _deepnote_index_column: 1
                    - airport_code: FKT
                      airport_name: Flocktopia
                      nb_passengers: 1685200
                      _deepnote_index_column: 2
                  type: dataframe
                text/plain: |2-
                    airport_code       airport_name  nb_passengers
                  0          AMP  Amazon Mothership        2423400
                  1          NSA   Nestland Airport        1999700
                  2          FKT         Flocktopia        1685200
              execution_count: 1
              output_type: execute_result
              metadata:
                cellId: 4609152afcd24c9bac056d0d2a0d48c9
                execution_start: 1764581170676
                execution_millis: 4187
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_2
                cellIndex: 3
                table_state_spec: '{}'
        - blockGroup: 1d9cf67a08454daa98182eee7ae6b4db
          content: ''
          id: 8d93df78e7ee461ba3d5e73fdbe672ff
          metadata:
            execution_start: 1764581231186
            execution_millis: 1
            execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
            deepnote_variable_name: df_2
            deepnote_config_collapsed: true
            deepnote_visualization_spec:
              layer:
                - layer:
                    - layer:
                        - mark:
                            clip: true
                            type: bar
                            color: '#2266D3'
                            tooltip: true
                          encoding:
                            x:
                              axis:
                                title: Aéroports
                              sort: null
                              type: nominal
                              field: airport_name
                              scale:
                                type: linear
                            'y':
                              axis:
                                title: Nombre de passagers
                                format:
                                  type: default
                                  decimals: null
                                formatType: numberFormatFromNumberType
                              type: quantitative
                              field: nb_passengers
                              scale:
                                type: linear
                              format:
                                type: default
                                decimals: null
                              aggregate: sum
                              formatType: numberFormatFromNumberType
                            color:
                              type: nominal
                              datum: nb_passengers
                              scale:
                                range:
                                  - '#2266D3'
                                domain:
                                  - nb_passengers
                            xOffset:
                              datum: series_0
                          transform: []
                  resolve:
                    scale:
                      color: independent
              title: Quel aéroport a transporté le plus de passagers ?
              config:
                legend:
                  orient: bottom
                  disable: false
              params:
                - name: valueLabelsColor
                  value: black
              $schema: https://vega.github.io/schema/vega-lite/v5.json
              encoding: {}
              usermeta:
                seriesNames:
                  - nb_passengers
                seriesOrder:
                  - 0
                specSchemaVersion: 2
                tooltipDefaultMode: true
            deepnote_chart_filter:
              advancedFilters: []
          sortingKey: w
          type: visualization
          executionCount: 13
          outputs:
            - data:
                application/vnd.vega.v5+json:
                  $schema: https://vega.github.io/schema/vega/v5.json
                  data:
                    - name: legend_size_0_store
                    - name: legend_color_0_store
                    - name: interval_selection_store
                    - name: source_0
                      values:
                        - airport_name: Amazon Mothership
                          sum_nb_passengers: 2423400
                        - airport_name: Nestland Airport
                          sum_nb_passengers: 1999700
                        - airport_name: Flocktopia
                          sum_nb_passengers: 1685200
                    - name: source_0_x_domain_airport_name
                      values:
                        - airport_name: Amazon Mothership
                        - airport_name: Nestland Airport
                        - airport_name: Flocktopia
                    - name: source_0_y_domain_sum_nb_passengers
                      values:
                        - min: 1685200
                          max: 2423400
                  signals:
                    - name: width
                      init: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                    - name: height
                      init: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                    - name: unit
                      value: {}
                      'on':
                        - events: pointermove
                          update: 'isTuple(group()) ? group() : unit'
                    - name: legend_size_0
                      update: vlSelectionResolve("legend_size_0_store", "union", true, true)
                    - name: legend_color_0
                      update: vlSelectionResolve("legend_color_0_store", "union", true, true)
                    - name: interval_selection
                      update: vlSelectionResolve("interval_selection_store", "union")
                    - name: valueLabelsColor
                      value: black
                    - name: legend_size_0_tuple
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'datum && item().mark.marktype !== ''group'' && indexof(item().mark.role, ''legend'') < 0 && indexof(item().mark.name, ''interval_selection_brush'') < 0 ? {unit: "layer_0_layer_0_layer_0", fields: legend_size_0_tuple_fields, values: []} : null'
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: 'null'
                    - name: legend_size_0_tuple_fields
                      value: []
                    - name: legend_size_0_toggle
                      value: false
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'true'
                        - events:
                            - source: view
                              type: dblclick
                          update: 'false'
                    - name: legend_size_0_modify
                      'on':
                        - events:
                            signal: legend_size_0_tuple
                          update: 'modify("legend_size_0_store", legend_size_0_toggle ? null : legend_size_0_tuple, legend_size_0_toggle ? null : true, legend_size_0_toggle ? legend_size_0_tuple : null)'
                    - name: legend_color_0_tuple
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'datum && item().mark.marktype !== ''group'' && indexof(item().mark.role, ''legend'') < 0 && indexof(item().mark.name, ''interval_selection_brush'') < 0 ? {unit: "layer_0_layer_0_layer_0", fields: legend_color_0_tuple_fields, values: []} : null'
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: 'null'
                    - name: legend_color_0_tuple_fields
                      value: []
                    - name: legend_color_0_toggle
                      value: false
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'true'
                        - events:
                            - source: view
                              type: dblclick
                          update: 'false'
                    - name: legend_color_0_modify
                      'on':
                        - events:
                            signal: legend_color_0_tuple
                          update: 'modify("legend_color_0_store", legend_color_0_toggle ? null : legend_color_0_tuple, legend_color_0_toggle ? null : true, legend_color_0_toggle ? legend_color_0_tuple : null)'
                    - name: interval_selection_x
                      value: []
                      'on':
                        - events:
                            source: scope
                            filter:
                              - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                            type: pointerdown
                          update: '[x(unit), x(unit)]'
                        - events:
                            source: window
                            between:
                              - source: scope
                                filter:
                                  - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                                type: pointerdown
                              - source: window
                                type: pointerup
                            type: pointermove
                            consume: true
                          update: '[interval_selection_x[0], clamp(x(unit), 0, width)]'
                        - events:
                            signal: interval_selection_scale_trigger
                          update: '[0, 0]'
                        - events:
                            - source: view
                              type: dblclick
                          update: '[0, 0]'
                        - events:
                            signal: interval_selection_translate_delta
                          update: clampRange(panLinear(interval_selection_translate_anchor.extent_x, interval_selection_translate_delta.x / span(interval_selection_translate_anchor.extent_x)), 0, width)
                        - events:
                            signal: interval_selection_zoom_delta
                          update: clampRange(zoomLinear(interval_selection_x, interval_selection_zoom_anchor.x, interval_selection_zoom_delta), 0, width)
                    - name: interval_selection_airport_name
                      'on':
                        - events:
                            signal: interval_selection_x
                          update: 'interval_selection_x[0] === interval_selection_x[1] ? null : invert("x", interval_selection_x)'
                    - name: interval_selection_scale_trigger
                      value: {}
                      'on':
                        - events:
                            - scale: x
                          update: '(!isArray(interval_selection_airport_name) || (invert("x", interval_selection_x)[0] === interval_selection_airport_name[0] && invert("x", interval_selection_x)[1] === interval_selection_airport_name[1])) ? interval_selection_scale_trigger : {}'
                    - name: interval_selection_tuple
                      'on':
                        - events:
                            - signal: interval_selection_airport_name
                          update: 'interval_selection_airport_name ? {unit: "layer_0_layer_0_layer_0", fields: interval_selection_tuple_fields, values: [interval_selection_airport_name]} : null'
                    - name: interval_selection_tuple_fields
                      value:
                        - field: airport_name
                          channel: x
                          type: E
                    - name: interval_selection_translate_anchor
                      value: {}
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: pointerdown
                          update: '{x: x(unit), y: y(unit), extent_x: slice(interval_selection_x)}'
                    - name: interval_selection_translate_delta
                      value: {}
                      'on':
                        - events:
                            - source: window
                              between:
                                - source: scope
                                  markname: interval_selection_brush
                                  type: pointerdown
                                - source: window
                                  type: pointerup
                              consume: true
                              type: pointermove
                          update: '{x: interval_selection_translate_anchor.x - x(unit), y: interval_selection_translate_anchor.y - y(unit)}'
                    - name: interval_selection_zoom_anchor
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: wheel
                              consume: true
                          update: '{x: x(unit), y: y(unit)}'
                    - name: interval_selection_zoom_delta
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: wheel
                              consume: true
                          update: pow(1.001, event.deltaY * pow(16, event.deltaMode))
                          force: true
                    - name: interval_selection_modify
                      'on':
                        - events:
                            signal: interval_selection_tuple
                          update: modify("interval_selection_store", interval_selection_tuple, true)
                  marks:
                    - type: rect
                      name: interval_selection_brush_bg
                      encode:
                        update:
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                        enter:
                          fillOpacity:
                            value: 0.125
                          fill:
                            value: '#333'
                      clip: true
                    - type: rect
                      name: layer_0_layer_0_layer_0_marks
                      from:
                        data: source_0
                      encode:
                        update:
                          x:
                            field: airport_name
                            scale: x
                            offset:
                              value: series_0
                              scale: xOffset
                          y2:
                            value: 0
                            scale: 'y'
                          fill:
                            value: nb_passengers
                            scale: layer_0_layer_0_color
                          'y':
                            field: sum_nb_passengers
                            scale: 'y'
                          opacity:
                            - value: 1
                              test: (!length(data("legend_size_0_store")) || vlSelectionTest("legend_size_0_store", datum)) && (!length(data("legend_color_0_store")) || vlSelectionTest("legend_color_0_store", datum)) && (!length(data("interval_selection_store")) || vlSelectionTest("interval_selection_store", datum))
                            - value: 0.2
                          width:
                            signal: max(0.25, bandwidth('xOffset'))
                          tooltip:
                            signal: '{"airport_name": isValid(datum["airport_name"]) ? datum["airport_name"] : ""+datum["airport_name"], "Sum of nb_passengers": numberFormatFromNumberType(datum["sum_nb_passengers"], {"decimals":null,"type":"default"})}'
                      style:
                        - bar
                      clip: true
                      interactive: true
                    - type: rect
                      name: interval_selection_brush
                      encode:
                        enter:
                          cursor:
                            value: move
                          fill:
                            value: transparent
                        update:
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          stroke:
                            - value: white
                              test: interval_selection_x[0] !== interval_selection_x[1]
                            - {}
                      clip: true
                  scales:
                    - name: x
                      type: band
                      domain:
                        data: source_0_x_domain_airport_name
                        field: airport_name
                      range:
                        - 0
                        - signal: width
                      paddingInner: 0.2
                      paddingOuter: 0.2
                    - name: 'y'
                      type: linear
                      domain:
                        - signal: (data("source_0_y_domain_sum_nb_passengers")[0] || {}).min
                        - signal: (data("source_0_y_domain_sum_nb_passengers")[0] || {}).max
                      range:
                        - signal: height
                        - 0
                      nice: true
                      zero: true
                    - name: xOffset
                      type: band
                      domain:
                        - series_0
                      range:
                        - 0
                        - signal: bandwidth('x')
                    - name: layer_0_layer_0_color
                      type: ordinal
                      domain:
                        - nb_passengers
                      range:
                        - '#2266D3'
                  axes:
                    - scale: 'y'
                      zindex: 0
                      ticks: false
                      grid: true
                      domain: false
                      gridScale: x
                      aria: false
                      maxExtent: 0
                      tickCount: 5
                      orient: left
                      minExtent: 0
                      labels: false
                    - scale: x
                      grid: false
                      orient: bottom
                      labelAlign: right
                      labelAngle: 270
                      labelBaseline: middle
                      zindex: 0
                      title: Aéroports
                    - scale: 'y'
                      encode:
                        labels:
                          update:
                            text:
                              signal: numberFormatFromNumberType(datum.value, {"decimals":null,"type":"default"})
                      orient: left
                      title: Nombre de passagers
                      zindex: 0
                      tickCount: 5
                      labelOverlap: true
                      grid: false
                  title:
                    text: Quel aéroport a transporté le plus de passagers ?
                    frame: group
                  usermeta:
                    tooltipDefaultMode: true
                    seriesNames:
                      - nb_passengers
                    specSchemaVersion: 2
                    seriesOrder:
                      - 0
                    outputMetadata:
                      rowLimitExceeded: false
                      rowLimit: 5000
                      filteredDataframeSize: 3
                      columns:
                        - name: airport_code
                          nativeType: object
                          distinctValues:
                            - AMP
                            - FKT
                            - NSA
                        - name: airport_name
                          nativeType: object
                          distinctValues:
                            - Amazon Mothership
                            - Flocktopia
                            - Nestland Airport
                        - name: nb_passengers
                          nativeType: int64
                          distinctValues:
                            - 1685200
                            - 1999700
                            - 2423400
                  autosize:
                    type: fit
                    contains: padding
                  legends:
                    - fill: layer_0_layer_0_color
                      direction: horizontal
                      symbolType: square
                      encode:
                        symbols:
                          update:
                            opacity:
                              value: 1
                  config:
                    customFormatTypes: true
                    legend:
                      orient: bottom
                      disable: false
                  padding: 5
                  background: white
                  style: cell
                text/plain: <deepnote_toolkit.chart.deepnote_chart.DeepnoteChart at 0x7fcf58d743d0>
              execution_count: 13
              output_type: execute_result
              metadata:
                cellId: 8d93df78e7ee461ba3d5e73fdbe672ff
                execution_start: 1764581231186
                execution_millis: 1
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_2
                deepnote_config_collapsed: true
                deepnote_visualization_spec:
                  layer:
                    - layer:
                        - layer:
                            - mark:
                                clip: true
                                type: bar
                                color: '#2266D3'
                                tooltip: true
                              encoding:
                                x:
                                  axis:
                                    title: Aéroports
                                  sort: null
                                  type: nominal
                                  field: airport_name
                                  scale:
                                    type: linear
                                'y':
                                  axis:
                                    title: Nombre de passagers
                                    format:
                                      type: default
                                      decimals: null
                                    formatType: numberFormatFromNumberType
                                  type: quantitative
                                  field: nb_passengers
                                  scale:
                                    type: linear
                                  format:
                                    type: default
                                    decimals: null
                                  aggregate: sum
                                  formatType: numberFormatFromNumberType
                                color:
                                  type: nominal
                                  datum: nb_passengers
                                  scale:
                                    range:
                                      - '#2266D3'
                                    domain:
                                      - nb_passengers
                                xOffset:
                                  datum: series_0
                              transform: []
                      resolve:
                        scale:
                          color: independent
                  title: Quel aéroport a transporté le plus de passagers ?
                  config:
                    legend:
                      orient: bottom
                      disable: false
                  params:
                    - name: valueLabelsColor
                      value: black
                  $schema: https://vega.github.io/schema/vega-lite/v5.json
                  encoding: {}
                  usermeta:
                    seriesNames:
                      - nb_passengers
                    seriesOrder:
                      - 0
                    specSchemaVersion: 2
                    tooltipDefaultMode: true
                cellIndex: 4
        - blockGroup: 1c519f41ff7a459bbb17011a57d46edc
          content: |-
            WITH airline_year_rpm AS (
                SELECT
                    al.airline_name,
                    EXTRACT(year FROM fs.date) AS flight_year,
                    SUM(fs.rpm_total) AS total_rpm,
                    SUM(COALESCE(fs.rpm_domestic, 0)) AS total_rpm_domestic,
                    SUM(COALESCE(fs.rpm_international, 0)) AS total_rpm_international
                FROM analytics.dbt_mbreuillard.dim_airline al
                LEFT JOIN analytics.dbt_mbreuillard.fct_flight_summary fs 
                    ON al.airline_code = fs.airline_code
                GROUP BY 1, 2
            ),

            best_rpm AS (
                SELECT *
                FROM airline_year_rpm a
                WHERE total_rpm = (
                    SELECT MAX(total_rpm)
                    FROM airline_year_rpm
                    WHERE airline_name = a.airline_name
                )
            )

            SELECT
                airline_name,
                flight_year AS best_year,
                total_rpm,
                total_rpm_domestic,
                total_rpm_international
            FROM best_rpm
            ORDER BY airline_name;
          id: 0296af9919834e499d1f4992afbbb5ac
          metadata:
            execution_start: 1764581789016
            execution_millis: 3589
            sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
            execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
            deepnote_variable_name: df_3
          sortingKey: x
          type: sql
          executionCount: 22
          outputs:
            - data:
                application/vnd.deepnote.sql-output-metadata+json:
                  status: success_no_cache
                  size_in_bytes: 436
                  compiled_query: |-
                    WITH airline_year_rpm AS (
                        SELECT
                            al.airline_name,
                            EXTRACT(year FROM fs.date) AS flight_year,
                            SUM(fs.rpm_total) AS total_rpm,
                            SUM(COALESCE(fs.rpm_domestic, 0)) AS total_rpm_domestic,
                            SUM(COALESCE(fs.rpm_international, 0)) AS total_rpm_international
                        FROM analytics.dbt_mbreuillard.dim_airline al
                        LEFT JOIN analytics.dbt_mbreuillard.fct_flight_summary fs 
                            ON al.airline_code = fs.airline_code
                        GROUP BY 1, 2
                    ),

                    best_rpm AS (
                        SELECT *
                        FROM airline_year_rpm a
                        WHERE total_rpm = (
                            SELECT MAX(total_rpm)
                            FROM airline_year_rpm
                            WHERE airline_name = a.airline_name
                        )
                    )

                    SELECT
                        airline_name,
                        flight_year AS best_year,
                        total_rpm,
                        total_rpm_domestic,
                        total_rpm_international
                    FROM best_rpm
                    ORDER BY airline_name
                    /* {"app":"deepnote","submitted_by":"user","user_email":"maxbreuillard@gmail.com","workspace_id":"a9190dce-d37e-4e25-9fc6-41e64813a5a6","project_id":"c58cfd1e-ddf2-4b4c-a25b-5b012084bab0","notebook_id":"bc4730be67b5410399901766344c501e","project_url":"https://deepnote.com/project/c58cfd1e-ddf2-4b4c-a25b-5b012084bab0"} */;
                  variable_type: dataframe
                  integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
              execution_count: 0
              output_type: execute_result
              metadata:
                cellId: 0296af9919834e499d1f4992afbbb5ac
                execution_start: 1764581789016
                execution_millis: 3589
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_3
                cellIndex: 5
            - data:
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>airline_name</th>
                        <th>best_year</th>
                        <th>total_rpm</th>
                        <th>total_rpm_domestic</th>
                        <th>total_rpm_international</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>Amazon Airlines</td>
                        <td>2015</td>
                        <td>95300752.0</td>
                        <td>73400352.0</td>
                        <td>21900400.0</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>Flock Air</td>
                        <td>2016</td>
                        <td>34637336.0</td>
                        <td>26811548.0</td>
                        <td>7825788.0</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>Goose Airways</td>
                        <td>2016</td>
                        <td>394081776.0</td>
                        <td>277102728.0</td>
                        <td>116979048.0</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 5
                  columns:
                    - name: airline_name
                      dtype: object
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: Amazon Airlines
                            count: 1
                          - name: Flock Air
                            count: 1
                          - name: Goose Airways
                            count: 1
                    - name: best_year
                      dtype: int64
                      stats:
                        unique_count: 2
                        nan_count: 0
                        min: '2015'
                        max: '2016'
                        histogram:
                          - bin_start: 2015
                            bin_end: 2015.1
                            count: 1
                          - bin_start: 2015.1
                            bin_end: 2015.2
                            count: 0
                          - bin_start: 2015.2
                            bin_end: 2015.3
                            count: 0
                          - bin_start: 2015.3
                            bin_end: 2015.4
                            count: 0
                          - bin_start: 2015.4
                            bin_end: 2015.5
                            count: 0
                          - bin_start: 2015.5
                            bin_end: 2015.6
                            count: 0
                          - bin_start: 2015.6
                            bin_end: 2015.7
                            count: 0
                          - bin_start: 2015.7
                            bin_end: 2015.8
                            count: 0
                          - bin_start: 2015.8
                            bin_end: 2015.9
                            count: 0
                          - bin_start: 2015.9
                            bin_end: 2016
                            count: 2
                        categories: null
                    - name: total_rpm
                      dtype: float64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: '34637336.0'
                        max: '394081776.0'
                        histogram:
                          - bin_start: 34637336
                            bin_end: 70581780
                            count: 1
                          - bin_start: 70581780
                            bin_end: 106526224
                            count: 1
                          - bin_start: 106526224
                            bin_end: 142470668
                            count: 0
                          - bin_start: 142470668
                            bin_end: 178415112
                            count: 0
                          - bin_start: 178415112
                            bin_end: 214359556
                            count: 0
                          - bin_start: 214359556
                            bin_end: 250304000
                            count: 0
                          - bin_start: 250304000
                            bin_end: 286248444
                            count: 0
                          - bin_start: 286248444
                            bin_end: 322192888
                            count: 0
                          - bin_start: 322192888
                            bin_end: 358137332
                            count: 0
                          - bin_start: 358137332
                            bin_end: 394081776
                            count: 1
                        categories: null
                    - name: total_rpm_domestic
                      dtype: float64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: '26811548.0'
                        max: '277102728.0'
                        histogram:
                          - bin_start: 26811548
                            bin_end: 51840666
                            count: 1
                          - bin_start: 51840666
                            bin_end: 76869784
                            count: 1
                          - bin_start: 76869784
                            bin_end: 101898902
                            count: 0
                          - bin_start: 101898902
                            bin_end: 126928020
                            count: 0
                          - bin_start: 126928020
                            bin_end: 151957138
                            count: 0
                          - bin_start: 151957138
                            bin_end: 176986256
                            count: 0
                          - bin_start: 176986256
                            bin_end: 202015374
                            count: 0
                          - bin_start: 202015374
                            bin_end: 227044492
                            count: 0
                          - bin_start: 227044492
                            bin_end: 252073610
                            count: 0
                          - bin_start: 252073610
                            bin_end: 277102728
                            count: 1
                        categories: null
                    - name: total_rpm_international
                      dtype: float64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: '7825788.0'
                        max: '116979048.0'
                        histogram:
                          - bin_start: 7825788
                            bin_end: 18741114
                            count: 1
                          - bin_start: 18741114
                            bin_end: 29656440
                            count: 1
                          - bin_start: 29656440
                            bin_end: 40571766
                            count: 0
                          - bin_start: 40571766
                            bin_end: 51487092
                            count: 0
                          - bin_start: 51487092
                            bin_end: 62402418
                            count: 0
                          - bin_start: 62402418
                            bin_end: 73317744
                            count: 0
                          - bin_start: 73317744
                            bin_end: 84233070
                            count: 0
                          - bin_start: 84233070
                            bin_end: 95148396
                            count: 0
                          - bin_start: 95148396
                            bin_end: 106063722
                            count: 0
                          - bin_start: 106063722
                            bin_end: 116979048
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 3
                  preview_row_count: 3
                  rows:
                    - airline_name: Amazon Airlines
                      best_year: 2015
                      total_rpm: 95300752
                      total_rpm_domestic: 73400352
                      total_rpm_international: 21900400
                      _deepnote_index_column: 0
                    - airline_name: Flock Air
                      best_year: 2016
                      total_rpm: 34637336
                      total_rpm_domestic: 26811548
                      total_rpm_international: 7825788
                      _deepnote_index_column: 1
                    - airline_name: Goose Airways
                      best_year: 2016
                      total_rpm: 394081776
                      total_rpm_domestic: 277102728
                      total_rpm_international: 116979048
                      _deepnote_index_column: 2
                  type: dataframe
                text/plain: |2-
                        airline_name  best_year    total_rpm  total_rpm_domestic  \
                  0  Amazon Airlines       2015   95300752.0          73400352.0   
                  1        Flock Air       2016   34637336.0          26811548.0   
                  2    Goose Airways       2016  394081776.0         277102728.0   

                     total_rpm_international  
                  0               21900400.0  
                  1                7825788.0  
                  2              116979048.0  
              execution_count: 22
              output_type: execute_result
              metadata:
                cellId: 0296af9919834e499d1f4992afbbb5ac
                execution_start: 1764581789016
                execution_millis: 3589
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_3
                cellIndex: 5
                table_state_spec: '{}'
        - blockGroup: 8429753dabfe4bc29aecb2db200f2fd6
          content: ''
          id: d0978e010ebf4dfeac38f022c0fa1d5e
          metadata:
            execution_start: 1764584135721
            execution_millis: 12
            execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
            deepnote_variable_name: df_3
            deepnote_config_collapsed: true
            deepnote_visualization_spec:
              layer:
                - layer:
                    - layer:
                        - mark:
                            clip: true
                            type: bar
                            tooltip: false
                          encoding:
                            x:
                              axis:
                                title: Compagnie aérienne
                              sort: null
                              type: nominal
                              field: airline_name
                              scale:
                                type: linear
                            'y':
                              axis:
                                title: Année
                                format:
                                  type: default
                                  decimals: null
                                formatType: numberFormatFromNumberType
                              type: quantitative
                              field: best_year
                              scale:
                                type: linear
                                domainMax: 2018
                                domainMin: 2010
                              format:
                                type: default
                                decimals: null
                              aggregate: sum
                              formatType: numberFormatFromNumberType
                            color:
                              sort: null
                              type: quantitative
                              field: total_rpm
                              scale:
                                scheme: deepnote_blues
                            tooltip: []
                            xOffset:
                              datum: series_0
                          transform: []
                  resolve:
                    scale:
                      color: independent
              title: Quelle a été la meilleure année en RPM pour chaque compagnie aérienne ?
              config:
                legend:
                  disable: false
              params:
                - name: valueLabelsColor
                  value: black
              $schema: https://vega.github.io/schema/vega-lite/v5.json
              encoding: {}
              usermeta:
                seriesNames:
                  - best_year
                seriesOrder:
                  - 0
                specSchemaVersion: 2
                tooltipDefaultMode: false
            deepnote_chart_filter:
              advancedFilters: []
          sortingKey: 'y'
          type: visualization
          executionCount: 262
          outputs:
            - data:
                application/vnd.vega.v5+json:
                  $schema: https://vega.github.io/schema/vega/v5.json
                  data:
                    - name: legend_size_0_store
                    - name: legend_color_0_store
                    - name: interval_selection_store
                    - name: source_0
                      values:
                        - airline_name: Amazon Airlines
                          total_rpm: 95300752
                          sum_best_year: 2015
                          sum_best_year_end: 2015
                          sum_best_year_start: 0
                        - airline_name: Flock Air
                          total_rpm: 34637336
                          sum_best_year: 2016
                          sum_best_year_end: 2016
                          sum_best_year_start: 0
                        - airline_name: Goose Airways
                          total_rpm: 394081776
                          sum_best_year: 2016
                          sum_best_year_end: 2016
                          sum_best_year_start: 0
                    - name: source_0_x_domain_airline_name
                      values:
                        - airline_name: Amazon Airlines
                        - airline_name: Flock Air
                        - airline_name: Goose Airways
                    - name: source_0_layer_0_layer_0_color_domain_total_rpm
                      values:
                        - min: 34637336
                          max: 394081776
                  signals:
                    - name: width
                      init: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                    - name: height
                      init: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                    - name: unit
                      value: {}
                      'on':
                        - events: pointermove
                          update: 'isTuple(group()) ? group() : unit'
                    - name: legend_color_0_total_rpm_legend
                      value: null
                      'on':
                        - events:
                            - source: view
                              markname: total_rpm_legend_symbols
                              type: click
                            - source: view
                              markname: total_rpm_legend_labels
                              type: click
                            - source: view
                              markname: total_rpm_legend_entries
                              type: click
                          update: 'isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value'
                          force: true
                        - events:
                            - source: view
                              type: click
                          update: '!event.item || !datum ? null : legend_color_0_total_rpm_legend'
                          force: true
                    - name: legend_size_0
                      update: vlSelectionResolve("legend_size_0_store", "union", true, true)
                    - name: legend_color_0
                      update: vlSelectionResolve("legend_color_0_store", "union", true, true)
                    - name: interval_selection
                      update: vlSelectionResolve("interval_selection_store", "union")
                    - name: valueLabelsColor
                      value: black
                    - name: legend_size_0_tuple
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'datum && item().mark.marktype !== ''group'' && indexof(item().mark.role, ''legend'') < 0 && indexof(item().mark.name, ''interval_selection_brush'') < 0 ? {unit: "layer_0_layer_0_layer_0", fields: legend_size_0_tuple_fields, values: []} : null'
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: 'null'
                    - name: legend_size_0_tuple_fields
                      value: []
                    - name: legend_size_0_toggle
                      value: false
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'true'
                        - events:
                            - source: view
                              type: dblclick
                          update: 'false'
                    - name: legend_size_0_modify
                      'on':
                        - events:
                            signal: legend_size_0_tuple
                          update: 'modify("legend_size_0_store", legend_size_0_toggle ? null : legend_size_0_tuple, legend_size_0_toggle ? null : true, legend_size_0_toggle ? legend_size_0_tuple : null)'
                    - name: legend_color_0_tuple
                      update: 'legend_color_0_total_rpm_legend !== null ? {fields: legend_color_0_tuple_fields, values: [legend_color_0_total_rpm_legend]} : null'
                    - name: legend_color_0_tuple_fields
                      value:
                        - field: total_rpm
                          channel: color
                          type: E
                    - name: legend_color_0_toggle
                      value: false
                      'on':
                        - events:
                            merge:
                              - source: view
                                type: click
                          update: 'true'
                    - name: legend_color_0_modify
                      'on':
                        - events:
                            signal: legend_color_0_tuple
                          update: 'modify("legend_color_0_store", legend_color_0_toggle ? null : legend_color_0_tuple, legend_color_0_toggle ? null : true, legend_color_0_toggle ? legend_color_0_tuple : null)'
                    - name: interval_selection_x
                      value: []
                      'on':
                        - events:
                            source: scope
                            filter:
                              - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                            type: pointerdown
                          update: '[x(unit), x(unit)]'
                        - events:
                            source: window
                            between:
                              - source: scope
                                filter:
                                  - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                                type: pointerdown
                              - source: window
                                type: pointerup
                            type: pointermove
                            consume: true
                          update: '[interval_selection_x[0], clamp(x(unit), 0, width)]'
                        - events:
                            signal: interval_selection_scale_trigger
                          update: '[0, 0]'
                        - events:
                            - source: view
                              type: dblclick
                          update: '[0, 0]'
                        - events:
                            signal: interval_selection_translate_delta
                          update: clampRange(panLinear(interval_selection_translate_anchor.extent_x, interval_selection_translate_delta.x / span(interval_selection_translate_anchor.extent_x)), 0, width)
                        - events:
                            signal: interval_selection_zoom_delta
                          update: clampRange(zoomLinear(interval_selection_x, interval_selection_zoom_anchor.x, interval_selection_zoom_delta), 0, width)
                    - name: interval_selection_airline_name
                      'on':
                        - events:
                            signal: interval_selection_x
                          update: 'interval_selection_x[0] === interval_selection_x[1] ? null : invert("x", interval_selection_x)'
                    - name: interval_selection_scale_trigger
                      value: {}
                      'on':
                        - events:
                            - scale: x
                          update: '(!isArray(interval_selection_airline_name) || (invert("x", interval_selection_x)[0] === interval_selection_airline_name[0] && invert("x", interval_selection_x)[1] === interval_selection_airline_name[1])) ? interval_selection_scale_trigger : {}'
                    - name: interval_selection_tuple
                      'on':
                        - events:
                            - signal: interval_selection_airline_name
                          update: 'interval_selection_airline_name ? {unit: "layer_0_layer_0_layer_0", fields: interval_selection_tuple_fields, values: [interval_selection_airline_name]} : null'
                    - name: interval_selection_tuple_fields
                      value:
                        - field: airline_name
                          channel: x
                          type: E
                    - name: interval_selection_translate_anchor
                      value: {}
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: pointerdown
                          update: '{x: x(unit), y: y(unit), extent_x: slice(interval_selection_x)}'
                    - name: interval_selection_translate_delta
                      value: {}
                      'on':
                        - events:
                            - source: window
                              between:
                                - source: scope
                                  markname: interval_selection_brush
                                  type: pointerdown
                                - source: window
                                  type: pointerup
                              type: pointermove
                              consume: true
                          update: '{x: interval_selection_translate_anchor.x - x(unit), y: interval_selection_translate_anchor.y - y(unit)}'
                    - name: interval_selection_zoom_anchor
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              consume: true
                              type: wheel
                          update: '{x: x(unit), y: y(unit)}'
                    - name: interval_selection_zoom_delta
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              consume: true
                              type: wheel
                          update: pow(1.001, event.deltaY * pow(16, event.deltaMode))
                          force: true
                    - name: interval_selection_modify
                      'on':
                        - events:
                            signal: interval_selection_tuple
                          update: modify("interval_selection_store", interval_selection_tuple, true)
                  marks:
                    - type: rect
                      name: interval_selection_brush_bg
                      encode:
                        update:
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                        enter:
                          fillOpacity:
                            value: 0.125
                          fill:
                            value: '#333'
                      clip: true
                    - type: rect
                      name: layer_0_layer_0_layer_0_marks
                      from:
                        data: source_0
                      encode:
                        update:
                          y2:
                            field: sum_best_year_start
                            scale: 'y'
                          fill:
                            field: total_rpm
                            scale: layer_0_layer_0_color
                          'y':
                            field: sum_best_year_end
                            scale: 'y'
                          width:
                            signal: max(0.25, bandwidth('xOffset'))
                          opacity:
                            - value: 1
                              test: (!length(data("legend_size_0_store")) || vlSelectionTest("legend_size_0_store", datum)) && (!length(data("legend_color_0_store")) || vlSelectionTest("legend_color_0_store", datum)) && (!length(data("interval_selection_store")) || vlSelectionTest("interval_selection_store", datum))
                            - value: 0.2
                          x:
                            field: airline_name
                            scale: x
                            offset:
                              value: series_0
                              scale: xOffset
                      clip: true
                      style:
                        - bar
                      interactive: true
                    - type: rect
                      name: interval_selection_brush
                      encode:
                        update:
                          stroke:
                            - value: white
                              test: interval_selection_x[0] !== interval_selection_x[1]
                            - {}
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                        enter:
                          fill:
                            value: transparent
                          cursor:
                            value: move
                      clip: true
                  scales:
                    - name: x
                      type: band
                      domain:
                        data: source_0_x_domain_airline_name
                        field: airline_name
                      range:
                        - 0
                        - signal: width
                      paddingOuter: 0.2
                      paddingInner: 0.2
                    - name: 'y'
                      type: linear
                      domain:
                        data: source_0
                        fields:
                          - sum_best_year_start
                          - sum_best_year_end
                      range:
                        - signal: height
                        - 0
                      domainMin: 2010
                      domainMax: 2018
                      zero: true
                    - name: xOffset
                      type: band
                      domain:
                        - series_0
                      range:
                        - 0
                        - signal: bandwidth('x')
                    - name: layer_0_layer_0_color
                      type: linear
                      domain:
                        - signal: (data("source_0_layer_0_layer_0_color_domain_total_rpm")[0] || {}).min
                        - signal: (data("source_0_layer_0_layer_0_color_domain_total_rpm")[0] || {}).max
                      range:
                        scheme: deepnote_blues
                      interpolate: hcl
                      zero: false
                  axes:
                    - scale: 'y'
                      gridScale: x
                      grid: true
                      labels: false
                      ticks: false
                      tickCount: 5
                      minExtent: 0
                      zindex: 0
                      domain: false
                      maxExtent: 0
                      aria: false
                      orient: left
                    - scale: x
                      orient: bottom
                      zindex: 0
                      labelAlign: right
                      labelAngle: 270
                      labelBaseline: middle
                      grid: false
                      title: Compagnie aérienne
                    - scale: 'y'
                      grid: false
                      encode:
                        labels:
                          update:
                            text:
                              signal: numberFormatFromNumberType(datum.value, {"decimals":null,"type":"default"})
                      zindex: 0
                      title: Année
                      orient: left
                      tickCount: 5
                      labelOverlap: true
                  title:
                    text: Quelle a été la meilleure année en RPM pour chaque compagnie aérienne ?
                    frame: group
                  usermeta:
                    seriesNames:
                      - best_year
                    seriesOrder:
                      - 0
                    tooltipDefaultMode: false
                    specSchemaVersion: 2
                    outputMetadata:
                      rowLimitExceeded: false
                      rowLimit: 5000
                      filteredDataframeSize: 3
                      columns:
                        - name: airline_name
                          nativeType: object
                          distinctValues:
                            - Amazon Airlines
                            - Flock Air
                            - Goose Airways
                        - name: best_year
                          nativeType: int64
                          distinctValues:
                            - 2015
                            - 2016
                        - name: total_rpm
                          nativeType: float64
                          distinctValues:
                            - 34637336
                            - 95300752
                            - 394081776
                        - name: total_rpm_domestic
                          nativeType: float64
                          distinctValues:
                            - 26811548
                            - 73400352
                            - 277102728
                        - name: total_rpm_international
                          nativeType: float64
                          distinctValues:
                            - 7825788
                            - 21900400
                            - 116979048
                  autosize:
                    type: fit
                    contains: padding
                  background: white
                  legends:
                    - fill: layer_0_layer_0_color
                      gradientLength:
                        signal: clamp(height, 64, 200)
                      title: total_rpm
                      encode:
                        labels:
                          name: total_rpm_legend_labels
                          interactive: true
                          update:
                            opacity:
                              - test: (!length(data("legend_color_0_store")) || (legend_color_0["total_rpm"] && indexof(legend_color_0["total_rpm"], datum.value) >= 0))
                                value: 1
                              - value: 0.35
                        gradient:
                          name: total_rpm_legend_gradient
                          interactive: true
                          update:
                            opacity:
                              value: 1
                        entries:
                          name: total_rpm_legend_entries
                          interactive: true
                          update:
                            fill:
                              value: transparent
                  style: cell
                  padding: 5
                  config:
                    customFormatTypes: true
                    legend:
                      disable: false
                text/plain: <deepnote_toolkit.chart.deepnote_chart.DeepnoteChart at 0x7fcf50869dd0>
              execution_count: 262
              output_type: execute_result
              metadata:
                cellId: d0978e010ebf4dfeac38f022c0fa1d5e
                execution_start: 1764584135721
                execution_millis: 12
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_3
                deepnote_config_collapsed: true
                deepnote_visualization_spec:
                  layer:
                    - layer:
                        - layer:
                            - mark:
                                clip: true
                                type: bar
                                tooltip: false
                              encoding:
                                x:
                                  axis:
                                    title: Compagnie aérienne
                                  sort: null
                                  type: nominal
                                  field: airline_name
                                  scale:
                                    type: linear
                                'y':
                                  axis:
                                    title: Année
                                    format:
                                      type: default
                                      decimals: null
                                    formatType: numberFormatFromNumberType
                                  type: quantitative
                                  field: best_year
                                  scale:
                                    type: linear
                                    domainMax: 2018
                                    domainMin: 2010
                                  format:
                                    type: default
                                    decimals: null
                                  aggregate: sum
                                  formatType: numberFormatFromNumberType
                                color:
                                  sort: null
                                  type: quantitative
                                  field: total_rpm
                                  scale:
                                    scheme: deepnote_blues
                                tooltip: []
                                xOffset:
                                  datum: series_0
                              transform: []
                      resolve:
                        scale:
                          color: independent
                  title: Quelle a été la meilleure année en RPM pour chaque compagnie aérienne ?
                  config:
                    legend:
                      disable: false
                  params:
                    - name: valueLabelsColor
                      value: black
                  $schema: https://vega.github.io/schema/vega-lite/v5.json
                  encoding: {}
                  usermeta:
                    seriesNames:
                      - best_year
                    seriesOrder:
                      - 0
                    specSchemaVersion: 2
                    tooltipDefaultMode: false
                cellIndex: 6
        - blockGroup: 1405321ee29c4ffcb056e61d4a3a1df5
          content: |
            WITH yearly_asm AS (
                SELECT
                    al.airline_name,
                    EXTRACT(year FROM fs.date) AS flight_year,
                    AVG(fs.asm_domestic) AS avg_asm_domestic
                FROM analytics.dbt_mbreuillard.dim_airline al
                LEFT JOIN analytics.dbt_mbreuillard.fct_flight_summary fs 
                    ON al.airline_code = fs.airline_code
                GROUP BY 1, 2
            ),

            best_asm AS (
                SELECT *
                FROM yearly_asm a
                WHERE avg_asm_domestic = (
                    SELECT MAX(avg_asm_domestic)
                    FROM yearly_asm
                    WHERE airline_name = a.airline_name
                )
            )

            SELECT
                airline_name,
                flight_year AS best_growth_year,
                avg_asm_domestic
            FROM best_asm
            ORDER BY airline_name;
          id: 0ee7f151d7e04ce2956c3d0d9518c7bf
          metadata:
            execution_start: 1764582773586
            execution_millis: 4033
            sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
            execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
            deepnote_variable_name: df_4
          sortingKey: yU
          type: sql
          executionCount: 154
          outputs:
            - data:
                application/vnd.deepnote.sql-output-metadata+json:
                  status: success_no_cache
                  size_in_bytes: 388
                  compiled_query: |-
                    WITH yearly_asm AS (
                        SELECT
                            al.airline_name,
                            EXTRACT(year FROM fs.date) AS flight_year,
                            AVG(fs.asm_domestic) AS avg_asm_domestic
                        FROM analytics.dbt_mbreuillard.dim_airline al
                        LEFT JOIN analytics.dbt_mbreuillard.fct_flight_summary fs 
                            ON al.airline_code = fs.airline_code
                        GROUP BY 1, 2
                    ),

                    best_asm AS (
                        SELECT *
                        FROM yearly_asm a
                        WHERE avg_asm_domestic = (
                            SELECT MAX(avg_asm_domestic)
                            FROM yearly_asm
                            WHERE airline_name = a.airline_name
                        )
                    )

                    SELECT
                        airline_name,
                        flight_year AS best_growth_year,
                        avg_asm_domestic
                    FROM best_asm
                    ORDER BY airline_name
                    /* {"app":"deepnote","submitted_by":"user","user_email":"maxbreuillard@gmail.com","workspace_id":"a9190dce-d37e-4e25-9fc6-41e64813a5a6","project_id":"c58cfd1e-ddf2-4b4c-a25b-5b012084bab0","notebook_id":"bc4730be67b5410399901766344c501e","project_url":"https://deepnote.com/project/c58cfd1e-ddf2-4b4c-a25b-5b012084bab0"} */;
                  variable_type: dataframe
                  integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
              execution_count: 0
              output_type: execute_result
              metadata:
                cellId: 0ee7f151d7e04ce2956c3d0d9518c7bf
                execution_start: 1764582773586
                execution_millis: 4033
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_4
                cellIndex: 7
            - data:
                text/html: |-
                  <div>
                  <style scoped>
                      .dataframe tbody tr th:only-of-type {
                          vertical-align: middle;
                      }

                      .dataframe tbody tr th {
                          vertical-align: top;
                      }

                      .dataframe thead th {
                          text-align: right;
                      }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>airline_name</th>
                        <th>best_growth_year</th>
                        <th>avg_asm_domestic</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>Amazon Airlines</td>
                        <td>2002</td>
                        <td>3.159310e+05</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>Flock Air</td>
                        <td>2016</td>
                        <td>4.272554e+05</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>Goose Airways</td>
                        <td>2016</td>
                        <td>1.100640e+06</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
                application/vnd.deepnote.dataframe.v3+json:
                  column_count: 3
                  columns:
                    - name: airline_name
                      dtype: object
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: null
                        max: null
                        histogram: null
                        categories:
                          - name: Amazon Airlines
                            count: 1
                          - name: Flock Air
                            count: 1
                          - name: Goose Airways
                            count: 1
                    - name: best_growth_year
                      dtype: int64
                      stats:
                        unique_count: 2
                        nan_count: 0
                        min: '2002'
                        max: '2016'
                        histogram:
                          - bin_start: 2002
                            bin_end: 2003.4
                            count: 1
                          - bin_start: 2003.4
                            bin_end: 2004.8
                            count: 0
                          - bin_start: 2004.8
                            bin_end: 2006.2
                            count: 0
                          - bin_start: 2006.2
                            bin_end: 2007.6
                            count: 0
                          - bin_start: 2007.6
                            bin_end: 2009
                            count: 0
                          - bin_start: 2009
                            bin_end: 2010.4
                            count: 0
                          - bin_start: 2010.4
                            bin_end: 2011.8
                            count: 0
                          - bin_start: 2011.8
                            bin_end: 2013.2
                            count: 0
                          - bin_start: 2013.2
                            bin_end: 2014.6
                            count: 0
                          - bin_start: 2014.6
                            bin_end: 2016
                            count: 2
                        categories: null
                    - name: avg_asm_domestic
                      dtype: float64
                      stats:
                        unique_count: 3
                        nan_count: 0
                        min: '315931.0'
                        max: '1100639.5'
                        histogram:
                          - bin_start: 315931
                            bin_end: 394401.85
                            count: 1
                          - bin_start: 394401.85
                            bin_end: 472872.7
                            count: 1
                          - bin_start: 472872.7
                            bin_end: 551343.55
                            count: 0
                          - bin_start: 551343.55
                            bin_end: 629814.4
                            count: 0
                          - bin_start: 629814.4
                            bin_end: 708285.25
                            count: 0
                          - bin_start: 708285.25
                            bin_end: 786756.1000000001
                            count: 0
                          - bin_start: 786756.1000000001
                            bin_end: 865226.9500000001
                            count: 0
                          - bin_start: 865226.9500000001
                            bin_end: 943697.8
                            count: 0
                          - bin_start: 943697.8
                            bin_end: 1022168.65
                            count: 0
                          - bin_start: 1022168.65
                            bin_end: 1100639.5
                            count: 1
                        categories: null
                    - name: _deepnote_index_column
                      dtype: int64
                  row_count: 3
                  preview_row_count: 3
                  rows:
                    - airline_name: Amazon Airlines
                      best_growth_year: 2002
                      avg_asm_domestic: 315931
                      _deepnote_index_column: 0
                    - airline_name: Flock Air
                      best_growth_year: 2016
                      avg_asm_domestic: 427255.4166666667
                      _deepnote_index_column: 1
                    - airline_name: Goose Airways
                      best_growth_year: 2016
                      avg_asm_domestic: 1100639.5
                      _deepnote_index_column: 2
                  type: dataframe
                text/plain: |2-
                        airline_name  best_growth_year  avg_asm_domestic
                  0  Amazon Airlines              2002      3.159310e+05
                  1        Flock Air              2016      4.272554e+05
                  2    Goose Airways              2016      1.100640e+06
              execution_count: 154
              output_type: execute_result
              metadata:
                cellId: 0ee7f151d7e04ce2956c3d0d9518c7bf
                execution_start: 1764582773586
                execution_millis: 4033
                sql_integration_id: 79129477-f8a5-4066-9268-a1f0943d81ee
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_4
                cellIndex: 7
                table_state_spec: '{}'
        - blockGroup: 510fe722508643c18b9d0030ac5d5551
          content: ''
          id: f184402b8346447988264ab324260ef8
          metadata:
            execution_start: 1764583698432
            execution_millis: 63
            execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
            deepnote_variable_name: df_4
            deepnote_config_collapsed: true
            deepnote_visualization_spec:
              layer:
                - layer:
                    - layer:
                        - mark:
                            clip: true
                            type: bar
                            tooltip: true
                          encoding:
                            x:
                              axis:
                                title: Compagnie aérienne
                              sort: null
                              type: nominal
                              field: airline_name
                              scale:
                                type: linear
                            'y':
                              axis:
                                title: Année
                                format:
                                  type: default
                                  decimals: null
                                formatType: numberFormatFromNumberType
                              type: quantitative
                              field: best_growth_year
                              scale:
                                type: linear
                                domainMax: 2018
                                domainMin: 2000
                              format:
                                type: default
                                decimals: null
                              aggregate: sum
                              formatType: numberFormatFromNumberType
                            color:
                              sort: null
                              type: quantitative
                              field: avg_asm_domestic
                              scale:
                                scheme: deepnote_blues
                              aggregate: sum
                            xOffset:
                              datum: series_0
                          transform: []
                  resolve:
                    scale:
                      color: independent
              title: Quelle a été la meilleure année de croissance pour chaque compagnie aérienne ?
              config:
                legend:
                  disable: false
              params:
                - name: valueLabelsColor
                  value: black
              $schema: https://vega.github.io/schema/vega-lite/v5.json
              encoding: {}
              usermeta:
                seriesNames:
                  - best_growth_year
                seriesOrder:
                  - 0
                specSchemaVersion: 2
                tooltipDefaultMode: true
            deepnote_chart_filter:
              advancedFilters: []
          sortingKey: yj
          type: visualization
          executionCount: 226
          outputs:
            - data:
                application/vnd.vega.v5+json:
                  $schema: https://vega.github.io/schema/vega/v5.json
                  data:
                    - name: legend_size_0_store
                    - name: legend_color_0_store
                    - name: interval_selection_store
                    - name: source_0
                      values:
                        - airline_name: Amazon Airlines
                          sum_best_growth_year: 2002
                          sum_avg_asm_domestic: 315931
                        - airline_name: Flock Air
                          sum_best_growth_year: 2016
                          sum_avg_asm_domestic: 427255.4166666667
                        - airline_name: Goose Airways
                          sum_best_growth_year: 2016
                          sum_avg_asm_domestic: 1100639.5
                    - name: source_0_x_domain_airline_name
                      values:
                        - airline_name: Amazon Airlines
                        - airline_name: Flock Air
                        - airline_name: Goose Airways
                    - name: source_0_y_domain_sum_best_growth_year
                      values:
                        - min: 2002
                          max: 2016
                    - name: source_0_layer_0_layer_0_color_domain_sum_avg_asm_domestic
                      values:
                        - min: 315931
                          max: 1100639.5
                  signals:
                    - name: width
                      init: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[0]) ? containerSize()[0] : 200'
                    - name: height
                      init: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                      'on':
                        - events: window:resize
                          update: 'isFinite(containerSize()[1]) ? containerSize()[1] : 200'
                    - name: unit
                      value: {}
                      'on':
                        - events: pointermove
                          update: 'isTuple(group()) ? group() : unit'
                    - name: legend_size_0
                      update: vlSelectionResolve("legend_size_0_store", "union", true, true)
                    - name: legend_color_0
                      update: vlSelectionResolve("legend_color_0_store", "union", true, true)
                    - name: interval_selection
                      update: vlSelectionResolve("interval_selection_store", "union")
                    - name: valueLabelsColor
                      value: black
                    - name: legend_size_0_tuple
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'datum && item().mark.marktype !== ''group'' && indexof(item().mark.role, ''legend'') < 0 && indexof(item().mark.name, ''interval_selection_brush'') < 0 ? {unit: "layer_0_layer_0_layer_0", fields: legend_size_0_tuple_fields, values: []} : null'
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: 'null'
                    - name: legend_size_0_tuple_fields
                      value: []
                    - name: legend_size_0_toggle
                      value: false
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'true'
                        - events:
                            - source: view
                              type: dblclick
                          update: 'false'
                    - name: legend_size_0_modify
                      'on':
                        - events:
                            signal: legend_size_0_tuple
                          update: 'modify("legend_size_0_store", legend_size_0_toggle ? null : legend_size_0_tuple, legend_size_0_toggle ? null : true, legend_size_0_toggle ? legend_size_0_tuple : null)'
                    - name: legend_color_0_tuple
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'datum && item().mark.marktype !== ''group'' && indexof(item().mark.role, ''legend'') < 0 && indexof(item().mark.name, ''interval_selection_brush'') < 0 ? {unit: "layer_0_layer_0_layer_0", fields: legend_color_0_tuple_fields, values: []} : null'
                          force: true
                        - events:
                            - source: view
                              type: dblclick
                          update: 'null'
                    - name: legend_color_0_tuple_fields
                      value: []
                    - name: legend_color_0_toggle
                      value: false
                      'on':
                        - events:
                            - source: scope
                              type: click
                          update: 'true'
                        - events:
                            - source: view
                              type: dblclick
                          update: 'false'
                    - name: legend_color_0_modify
                      'on':
                        - events:
                            signal: legend_color_0_tuple
                          update: 'modify("legend_color_0_store", legend_color_0_toggle ? null : legend_color_0_tuple, legend_color_0_toggle ? null : true, legend_color_0_toggle ? legend_color_0_tuple : null)'
                    - name: interval_selection_x
                      value: []
                      'on':
                        - events:
                            source: scope
                            filter:
                              - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                            type: pointerdown
                          update: '[x(unit), x(unit)]'
                        - events:
                            source: window
                            between:
                              - source: scope
                                filter:
                                  - '!event.item || event.item.mark.name !== "interval_selection_brush"'
                                type: pointerdown
                              - source: window
                                type: pointerup
                            type: pointermove
                            consume: true
                          update: '[interval_selection_x[0], clamp(x(unit), 0, width)]'
                        - events:
                            signal: interval_selection_scale_trigger
                          update: '[0, 0]'
                        - events:
                            - source: view
                              type: dblclick
                          update: '[0, 0]'
                        - events:
                            signal: interval_selection_translate_delta
                          update: clampRange(panLinear(interval_selection_translate_anchor.extent_x, interval_selection_translate_delta.x / span(interval_selection_translate_anchor.extent_x)), 0, width)
                        - events:
                            signal: interval_selection_zoom_delta
                          update: clampRange(zoomLinear(interval_selection_x, interval_selection_zoom_anchor.x, interval_selection_zoom_delta), 0, width)
                    - name: interval_selection_airline_name
                      'on':
                        - events:
                            signal: interval_selection_x
                          update: 'interval_selection_x[0] === interval_selection_x[1] ? null : invert("x", interval_selection_x)'
                    - name: interval_selection_scale_trigger
                      value: {}
                      'on':
                        - events:
                            - scale: x
                          update: '(!isArray(interval_selection_airline_name) || (invert("x", interval_selection_x)[0] === interval_selection_airline_name[0] && invert("x", interval_selection_x)[1] === interval_selection_airline_name[1])) ? interval_selection_scale_trigger : {}'
                    - name: interval_selection_tuple
                      'on':
                        - events:
                            - signal: interval_selection_airline_name
                          update: 'interval_selection_airline_name ? {unit: "layer_0_layer_0_layer_0", fields: interval_selection_tuple_fields, values: [interval_selection_airline_name]} : null'
                    - name: interval_selection_tuple_fields
                      value:
                        - field: airline_name
                          channel: x
                          type: E
                    - name: interval_selection_translate_anchor
                      value: {}
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: pointerdown
                          update: '{x: x(unit), y: y(unit), extent_x: slice(interval_selection_x)}'
                    - name: interval_selection_translate_delta
                      value: {}
                      'on':
                        - events:
                            - source: window
                              between:
                                - source: scope
                                  markname: interval_selection_brush
                                  type: pointerdown
                                - source: window
                                  type: pointerup
                              type: pointermove
                              consume: true
                          update: '{x: interval_selection_translate_anchor.x - x(unit), y: interval_selection_translate_anchor.y - y(unit)}'
                    - name: interval_selection_zoom_anchor
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: wheel
                              consume: true
                          update: '{x: x(unit), y: y(unit)}'
                    - name: interval_selection_zoom_delta
                      'on':
                        - events:
                            - source: scope
                              markname: interval_selection_brush
                              type: wheel
                              consume: true
                          update: pow(1.001, event.deltaY * pow(16, event.deltaMode))
                          force: true
                    - name: interval_selection_modify
                      'on':
                        - events:
                            signal: interval_selection_tuple
                          update: modify("interval_selection_store", interval_selection_tuple, true)
                  marks:
                    - type: rect
                      name: interval_selection_brush_bg
                      encode:
                        enter:
                          fill:
                            value: '#333'
                          fillOpacity:
                            value: 0.125
                        update:
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                      clip: true
                    - type: rect
                      name: layer_0_layer_0_layer_0_marks
                      from:
                        data: source_0
                      encode:
                        update:
                          'y':
                            field: sum_best_growth_year
                            scale: 'y'
                          width:
                            signal: max(0.25, bandwidth('xOffset'))
                          x:
                            field: airline_name
                            scale: x
                            offset:
                              value: series_0
                              scale: xOffset
                          fill:
                            field: sum_avg_asm_domestic
                            scale: layer_0_layer_0_color
                          tooltip:
                            signal: '{"airline_name": isValid(datum["airline_name"]) ? datum["airline_name"] : ""+datum["airline_name"], "Sum of best_growth_year": numberFormatFromNumberType(datum["sum_best_growth_year"], {"decimals":null,"type":"default"}), "Sum of avg_asm_domestic": format(datum["sum_avg_asm_domestic"], "")}'
                          y2:
                            value: 0
                            scale: 'y'
                          opacity:
                            - value: 1
                              test: (!length(data("legend_size_0_store")) || vlSelectionTest("legend_size_0_store", datum)) && (!length(data("legend_color_0_store")) || vlSelectionTest("legend_color_0_store", datum)) && (!length(data("interval_selection_store")) || vlSelectionTest("interval_selection_store", datum))
                            - value: 0.2
                      interactive: true
                      clip: true
                      style:
                        - bar
                    - type: rect
                      name: interval_selection_brush
                      encode:
                        enter:
                          cursor:
                            value: move
                          fill:
                            value: transparent
                        update:
                          'y':
                            - value: 0
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x:
                            - signal: interval_selection_x[0]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          x2:
                            - signal: interval_selection_x[1]
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          y2:
                            - field:
                                signal: null
                                datum: null
                                group: height
                                parent: null
                              test: data("interval_selection_store").length && data("interval_selection_store")[0].unit === "layer_0_layer_0_layer_0"
                            - value: 0
                          stroke:
                            - value: white
                              test: interval_selection_x[0] !== interval_selection_x[1]
                            - {}
                      clip: true
                  scales:
                    - name: x
                      type: band
                      domain:
                        data: source_0_x_domain_airline_name
                        field: airline_name
                      range:
                        - 0
                        - signal: width
                      paddingInner: 0.2
                      paddingOuter: 0.2
                    - name: 'y'
                      type: linear
                      domain:
                        - signal: (data("source_0_y_domain_sum_best_growth_year")[0] || {}).min
                        - signal: (data("source_0_y_domain_sum_best_growth_year")[0] || {}).max
                      range:
                        - signal: height
                        - 0
                      domainMax: 2018
                      domainMin: 2000
                      zero: true
                    - name: xOffset
                      type: band
                      domain:
                        - series_0
                      range:
                        - 0
                        - signal: bandwidth('x')
                    - name: layer_0_layer_0_color
                      type: linear
                      domain:
                        - signal: (data("source_0_layer_0_layer_0_color_domain_sum_avg_asm_domestic")[0] || {}).min
                        - signal: (data("source_0_layer_0_layer_0_color_domain_sum_avg_asm_domestic")[0] || {}).max
                      range:
                        scheme: deepnote_blues
                      zero: false
                      interpolate: hcl
                  axes:
                    - scale: 'y'
                      zindex: 0
                      orient: left
                      ticks: false
                      aria: false
                      grid: true
                      gridScale: x
                      domain: false
                      maxExtent: 0
                      tickCount: 5
                      labels: false
                      minExtent: 0
                    - scale: x
                      labelBaseline: middle
                      labelAlign: right
                      title: Compagnie aérienne
                      grid: false
                      orient: bottom
                      zindex: 0
                      labelAngle: 270
                    - scale: 'y'
                      labelOverlap: true
                      encode:
                        labels:
                          update:
                            text:
                              signal: numberFormatFromNumberType(datum.value, {"decimals":null,"type":"default"})
                      tickCount: 5
                      zindex: 0
                      title: Année
                      orient: left
                      grid: false
                  title:
                    text: Quelle a été la meilleure année de croissance pour chaque compagnie aérienne ?
                    frame: group
                  usermeta:
                    seriesNames:
                      - best_growth_year
                    seriesOrder:
                      - 0
                    specSchemaVersion: 2
                    tooltipDefaultMode: true
                    outputMetadata:
                      rowLimitExceeded: false
                      rowLimit: 5000
                      filteredDataframeSize: 3
                      columns:
                        - name: airline_name
                          nativeType: object
                          distinctValues:
                            - Amazon Airlines
                            - Flock Air
                            - Goose Airways
                        - name: best_growth_year
                          nativeType: int64
                          distinctValues:
                            - 2002
                            - 2016
                        - name: avg_asm_domestic
                          nativeType: float64
                          distinctValues:
                            - 315931
                            - 427255.4166666667
                            - 1100639.5
                  style: cell
                  legends:
                    - fill: layer_0_layer_0_color
                      gradientLength:
                        signal: clamp(height, 64, 200)
                      title: Sum of avg_asm_domestic
                      encode:
                        gradient:
                          update:
                            opacity:
                              value: 1
                  autosize:
                    type: fit
                    contains: padding
                  background: white
                  padding: 5
                  config:
                    customFormatTypes: true
                    legend:
                      disable: false
                text/plain: <deepnote_toolkit.chart.deepnote_chart.DeepnoteChart at 0x7fcf501ed350>
              execution_count: 226
              output_type: execute_result
              metadata:
                cellId: f184402b8346447988264ab324260ef8
                execution_start: 1764583698432
                execution_millis: 63
                execution_context_id: 4bf56b2f-0b30-47c8-ab15-d733a74c81d2
                deepnote_variable_name: df_4
                deepnote_config_collapsed: true
                deepnote_visualization_spec:
                  layer:
                    - layer:
                        - layer:
                            - mark:
                                clip: true
                                type: bar
                                tooltip: true
                              encoding:
                                x:
                                  axis:
                                    title: Compagnie aérienne
                                  sort: null
                                  type: nominal
                                  field: airline_name
                                  scale:
                                    type: linear
                                'y':
                                  axis:
                                    title: Année
                                    format:
                                      type: default
                                      decimals: null
                                    formatType: numberFormatFromNumberType
                                  type: quantitative
                                  field: best_growth_year
                                  scale:
                                    type: linear
                                    domainMax: 2018
                                    domainMin: 2000
                                  format:
                                    type: default
                                    decimals: null
                                  aggregate: sum
                                  formatType: numberFormatFromNumberType
                                color:
                                  sort: null
                                  type: quantitative
                                  field: avg_asm_domestic
                                  scale:
                                    scheme: deepnote_blues
                                  aggregate: sum
                                xOffset:
                                  datum: series_0
                              transform: []
                      resolve:
                        scale:
                          color: independent
                  title: Quelle a été la meilleure année de croissance pour chaque compagnie aérienne ?
                  config:
                    legend:
                      disable: false
                  params:
                    - name: valueLabelsColor
                      value: black
                  $schema: https://vega.github.io/schema/vega-lite/v5.json
                  encoding: {}
                  usermeta:
                    seriesNames:
                      - best_growth_year
                    seriesOrder:
                      - 0
                    specSchemaVersion: 2
                    tooltipDefaultMode: true
                cellIndex: 8
      executionMode: block
      id: bc4730be67b5410399901766344c501e
      isModule: false
      name: Notebook 1
  settings: {}
version: 1.0.0
